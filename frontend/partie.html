<!DOCTYPE html>
<html lang="de">

<!-- Using bootstrap, see https://www.jsdelivr.com/package/npm/bootstrap-->
<!-- For all things like tables, forms, buttons, modals, tooltips, etc. see https://getbootstrap.com/docs/5.3/getting-started/introduction/-->
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="style.css" />
  <title>WIZARD - Partie</title>
  <script type="importmap">
    {
      "imports": {
        "partieberechnungen": "./partieberechnungen.js",
        "partietabelle": "./partietabelle.js"
      }
    }
  </script>
</head>

  
  
<body>
  <div id="navContainer" class="container-fluid">
  	<div class="row bg-primary text-white p-2"> 	
      <div class="col-6">
        <a href="index.html" class="btn btn-light btn-sm">
          <i class="bi-arrow-left"></i> Zurück
        </a>
      </div>
      <div class="col-6 text-end">
        <span class="badge bg-light text-dark" id="tableInfo">Tisch: -</span>
      </div>
    </div>
  </div>
  
  <h1 id="title" class="d-flex justify-content-center p-2 bg-wizardscore">
    WIZARD Score Sheet
  </h1>
  
  <div id="navContainer2" class="container">
  	<div class="row"> 	
    	<div class="col-xs-0 col-sm-0 col-md-2 col-lg-3"></div> 
      	<div class="col-xs-12 col-sm-12 col-md-8 col-lg-6"> 
          <nav class="navbar navbar-expand-lg marginBottom" style="background-color: white; white-space:nowrap;"> 
            <div class="container-fluid"> 
              <ul class="navbar-nav me-auto"> 
              <li class="nav-item"> 
                <div id="currentRoundInfo"> 
                  <div class="d-flex" style="align-items:center;"> 
                    <div style="padding-right:5px;">
                    	<span id="roundInfo" style="font-size:1.3rem;font-weight:bold;">
                          Runde 
                          <span class="currentRound">
                            2
                          </span>
                      </span>
                    </div> 
                    <div>
                      <span id="roundInfo2">
                        Jeder Spieler bekommt 
                        <span class="currentRound">
                          
                        </span> 
                        Karten
                      </span>
                    </div> 
                  </div> 
                </div> 
              </li> 
              </ul> 
              <div class="d-flex"> 
                <ul class="navbar-nav me-auto"> 
                  <li class="nav-item"> 
                    <button type="button" id="finishButton" class="btn btn-success" onclick="finishPartie()">
                      <i class="bi-check-circle-fill pe-1"></i>Partie beenden
                    </button> 
                  </li>
                </ul> 
              </div> 
            </div> 
          </nav> 
        </div> 
        <div class="col-xs-0 col-sm-0 col-md-2 col-lg-3">

        </div> 
      </div>
    </div>
    <div id="blockContainer" class="container text-center">
		<div class="row">
			<div class="col-xs-12 col-sm-12 col-md-12 col-lg-1 space" id="spaceStart">
			</div>

			<div class="col-xs-12 col-sm-12 col-md-12 col-lg-10" id="block">
        <div id="InputContainer" class="container sticky-top text-center p-2" style="background:white">
          <div class="row">
            <div class="col-1 align-self-center p-0">
              <div id="roundInfoTransform">
                Runde 
                <span class="currentRound">
                  1
                </span>
              </div>
            </div>
            <div class="col-11 align-content-center p-0 pe-2">
              <div class="container">
                <div id="playerRow" class="row" data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="Spieler">
                  <div class="col-3 playerName">
                    <span id="player1" class="position-relative">
                      01
                      <span id="shufflerSpan" class="position-absolute top-50 start-100 translate-middle" style="padding-left: 20px" data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="Geber">
                        <i class="bi-files">

                        </i>
                      </span>
                    </span>
                  </div>
                  <div class="col-3 playerName">
                    <span id="player2" class="position-relative">
                      02
                    </span>
                  </div>
                  <div class="col-3 playerName">
                    <span id="player3" class="position-relative">
                      03
                    </span>
                  </div>
                  <div class="col-3 playerName">
                    <span id="player4" class="position-relative">
                      04
                    </span>
                  </div>
                </div>
                <div id="scoreRow" class="row" data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="Gesamtpunktzahl">
                  <div class="col-3">
                    <h4><span id="points1" class="badge text-bg-light">
                      0
                    </span>
                  </h4>
                </div>
                <div class="col-3">
                  <h4>
                    <span id="points2" class="badge text-bg-light">
                      0
                    </span>
                  </h4>
                </div>
                <div class="col-3">
                  <h4>
                    <span id="points3" class="badge text-bg-light">
                      0
                    </span>
                  </h4>
                </div>
                <div class="col-3">
                  <h4>
                    <span id="points4" class="badge text-bg-light">
                      0
                    </span>
                  </h4>
                </div>
              </div>
              <div class="row" data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="Schätzung">
                <div class="col-3 inputField"> 
                  <input type="text" class="form-control bid inputBold" placeholder="Schätzung" id="bid1" inputmode="numeric" pattern="[0-9]*" oninput="validateNumber(this);" style="text-align: center;"> 
                  <div class="invalid-feedback">
                    Ungültige Zahl
                  </div> 
                </div>
                <div class="col-3 inputField"> 
                  <input type="text" class="form-control bid inputBold" placeholder="Schätzung" id="bid2" inputmode="numeric" pattern="[0-9]*" oninput="validateNumber(this);" style="text-align: center;"> 
                  <div class="invalid-feedback">
                    Ungültige Zahl
                  </div> 
                </div>
                <div class="col-3 inputField"> 
                  <input type="text" class="form-control bid inputBold" placeholder="Schätzung" id="bid3" inputmode="numeric" pattern="[0-9]*" oninput="validateNumber(this);" style="text-align: center;"> 
                  <div class="invalid-feedback">
                    Ungültige Zahl
                  </div> 
                </div>
                <div class="col-3 inputField"> 
                  <input type="text" class="form-control bid inputBold" placeholder="Schätzung" id="bid4" inputmode="numeric" pattern="[0-9]*" oninput="validateNumber(this);" style="text-align: center;"> 
                  <div class="invalid-feedback">
                    Ungültige Zahl
                  </div> 
                </div>
              </div>
              <div class="row" data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="Tatsächliche Stiche">
                <div class="col-3 inputField"> 
                  <input type="text" class="form-control actual inputBold" placeholder="Stiche" id="actual1" inputmode="numeric" pattern="[0-9]*" oninput="validateNumber2(this);" style="text-align: center;"> 
                  <div class="invalid-feedback">
                    Ungültige Zahl
                  </div> 
                </div>
                <div class="col-3 inputField"> 
                  <input type="text" class="form-control actual inputBold" placeholder="Stiche" id="actual2" inputmode="numeric" pattern="[0-9]*" oninput="validateNumber2(this);" style="text-align: center;"> 
                  <div class="invalid-feedback">
                    Ungültige Zahl
                  </div> 
                </div>
                <div class="col-3 inputField"> 
                  <input type="text" class="form-control actual inputBold" placeholder="Stiche" id="actual3" inputmode="numeric" pattern="[0-9]*" oninput="validateNumber2(this);" style="text-align: center;"> 
                  <div class="invalid-feedback">
                    Ungültige Zahl
                  </div> 
                </div>
                <div class="col-3 inputField"> 
                  <input type="text" class="form-control actual inputBold" placeholder="Stiche" id="actual4" inputmode="numeric" pattern="[0-9]*" oninput="validateNumber2(this);" style="text-align: center;"> 
                  <div class="invalid-feedback">
                    Ungültige Zahl
                  </div> 
                </div>
              </div>
              <div id="InputSubmit" class="row"> 
                <div class="col-xs-1 col-sm-1 col-md-2"> 

                </div> 
                <div class="col-xs-10 col-sm-10 col-md-8"> 
                  <div class="btn-group pt-2 pb-2"> 
                    <div class="p-1"> 
                      <button type="button" id="submitRoundButton" class="btn btn-primary" onclick="submitRound()">
                        <i class="bi-box-arrow-in-down pe-1">

                        </i>
                        Runde abschließen 
                        <span id="SubmitRound">
                          1
                        </span>
                      </button> 
                    </div> 
                    <div class="p-1" data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="Letzte Runde rückgängig machen"> 
                      <button type="button" class="btn btn-danger" id="undoButton" data-bs-toggle="modal" data-bs-target="#modalUndoRound" disabled="">
                        <i class="bi-arrow-counterclockwise">

                        </i>
                      </button> 
                    </div> 
                  </div> 
                </div> 
                <div class="col-xs-1 col-sm-1 col-md-2"> 

                </div> 
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal fade" id="modalUndoRound" tabindex="-1" aria-labelledby="modalUndoRoundLabel" aria-hidden="true"> 
        <div class="modal-dialog"> 
          <div class="modal-content"> 
            <div class="modal-header"> 
              <h1 class="modal-title fs-5" id="modalUndoRoundLabel">
                Letzte Runde rückgängig machen?
              </h1> 
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">

              </button> 
            </div> 
            <div id="modalUndoRoundBody" class="modal-body">
              Möchtest du die letzte Runde wirklich rückgängig machen? 
            </div> 
            <div class="modal-footer"> 
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                Nein
              </button> 
              <button type="button" class="btn btn-danger" data-bs-dismiss="modal" onclick="undoRound()">
                Ja, rückgängig machen
              </button> 
            </div> 
          </div> 
        </div> 
      </div>
      <div id="ResultsContainer" class="container text-center card bg-light ps-1 pe-2 pt-2 pb-2">
      </div>
      <div class="modal fade" id="modalCheckRuleMaxGuess" tabindex="-1" aria-labelledby="modalCheckRuleMaxGuessLabel" aria-hidden="true">
         <div class="modal-dialog"> 
          <div class="modal-content"> 
            <div class="modal-header"> 
              <h1 class="modal-title fs-5" id="modalCheckRuleMaxGuessLabel">
                Anzahl der Stiche überschreitet Rundenzahl
              </h1> 
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">

              </button> 
            </div> 
            <div id="modalCheckRuleMaxGuessBody" class="modal-body"> 
              Ungültige Gesamtzahl der tatsächlichen Stiche. Die maximale Anzahl der Stiche in dieser Runde ist x 
            </div> 
            <div class="modal-footer"> 
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                Schließen
              </button> 
            </div> 
          </div> 
        </div> 
      </div>
      
      <!-- Finish Partie Modal -->
      <div class="modal fade" id="modalFinishPartie" tabindex="-1" aria-labelledby="modalFinishPartieLabel" aria-hidden="true"> 
        <div class="modal-dialog modal-lg"> 
          <div class="modal-content"> 
            <div class="modal-header bg-success text-white"> 
              <h1 class="modal-title fs-5" id="modalFinishPartieLabel">
                <i class="bi-trophy-fill"></i> Partie beenden
              </h1> 
              <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close">

              </button> 
            </div> 
            <div id="modalFinishPartieBody" class="modal-body"> 
              <p><strong>Möchtest du diese Partie wirklich beenden?</strong></p>
              <div id="finalRanking" class="card mt-3">
                <div class="card-header">
                  Endergebnis
                </div>
                <div class="card-body" id="finalRankingBody">
                  <!-- Will be filled dynamically -->
                </div>
              </div>
            </div> 
            <div class="modal-footer"> 
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                Abbrechen
              </button> 
              <button type="button" class="btn btn-success" onclick="confirmFinishPartie()">
                <i class="bi-check-circle-fill"></i> Ja, beenden & speichern
              </button> 
            </div> 
          </div> 
        </div> 
      </div>
      
    </div>
		<div class="col-xs-12 col-sm-12 col-md-12 col-lg-1 space" id="spaceEnd">
		</div>
	</div>
  <p>
    
  </p>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  <script type="module" src="ui-handlers.js"></script>
</body>

</html>
